[{"name":"app.R","content":"library(shiny)\nlibrary(glue)\n\n## globals\nplay_once <- function() {\n  flips <- sample(c(\"Heads\", \"Tails\"), size = 2, replace = TRUE)\n  possible_winnings <- c(-1, 0, 2)\n  number_heads <- sum(flips == \"Heads\")\n  winnings <- possible_winnings[number_heads + 1]\n  list(flips = flips, winnings = winnings)\n}\n\n## ui\nui <- pageWithSidebar(\n  headerPanel = titlePanel(\"Coin-Flipping Game\"),\n  sidebarPanel = sidebarPanel(\n    actionButton(\"go\", \"Play Game\"),\n    actionButton(\"restart\", \"Start Over\")\n  ),\n  mainPanel = mainPanel(verbatimTextOutput(\"report\"))\n)\n\n\n## server logic\nserver <- function(input, output) {\n  \n  rv <- reactiveValues(\n    total = 0,\n    plays = 0,\n    msg = \"\"\n  )\n  \n  observeEvent(input$restart, {\n    rv$total <- 0\n    rv$plays <- 0\n    rv$msg <- \"\"\n  })\n  \n  observeEvent(input$go, {\n    res <- play_once()\n    rv$total <- rv$total + res$winnings\n    rv$plays <- rv$plays + 1\n    avg <- round(rv$total/ rv$plays, digits = 3)\n    msg <- glue(\n      \"You got {res$flips[1]} and then {res$flips[2]}.\n       You receive {res$winnings} dollars.\n      \n       After {rv$plays} play(s), your net winnings are:  {rv$total} dollars.\n       Your average winnings per play so far is:  {avg} dollars.\"\n    )\n    print(msg)\n    rv$msg <- msg\n  })\n\n  output$report <- renderText({\n    rv$msg\n  })\n}\n\n# run it\nshinyApp(ui = ui, server = server)","type":"text"}]
